[{"_path":"/guide/welcome/security","_dir":"welcome","_draft":false,"_partial":false,"_locale":"en","_empty":false,"title":"Security","description":"This section mostly contains a list of possible security problems. Note that the below flaws exist with many libraries and frameworks we use in our day-to-day when building and working with APIs. Even your vanilla Nuxt app already possesses some of these shortcoming. Missing in the below list are estimates of how likely it is that one of the list-items may occur and what impact it will have on your app. This is because that heavily depends on:","excerpt":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"security"},"children":[{"type":"text","value":"Security"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This section mostly contains a list of possible security problems. Note that the below flaws exist with many libraries and frameworks we use in our day-to-day when building and working with APIs. Even your vanilla Nuxt app already possesses some of these shortcoming. Missing in the below list are estimates of how likely it is that one of the list-items may occur and what impact it will have on your app. This is because that heavily depends on:"}]},{"type":"element","tag":"alert","props":{"type":"warning"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"your app"}]},{"type":"text","value":": Are you building a fun project? A proof of concept? The next fort-nox money management app?"}]}]},{"type":"element","tag":"alert","props":{"type":"warning"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"your environment"}]},{"type":"text","value":": Building a freely available app for fun? Have authentication in front of your app and trust all users that successfully authenticated? Superb! Don't trust anyone? Then please be extra-careful when using this library and when building you backend in general"}]}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Without further ado, here's some attack cases you can consider and take action against. Neither the attack vectors, the problems or the mitigations are exhaustive:"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"sending arbitrary data: Denial-of-Service by server-ressource exhaustion (bandwidth, cpu, memory), arbitrary code execution (if you parse the data), ..."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"creation arbitrarily many sessions: Denial-of-Service by server-ressource exhaustion (bandwidth, cpu, memory)"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"guessing correct session ids: session data can leak"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"stealing session id(s) of client(s): session data can leak"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Read up how to mitigate these and more issues if you see fit. Checkout the "},{"type":"element","tag":"a","props":{"href":"https://github.com/Baroshem/nuxt-security","rel":["nofollow"]},"children":[{"type":"text","value":"nuxt-security"}]},{"type":"text","value":" module that may help with some of these."}]},{"type":"element","tag":"h2","props":{"id":"disclosure"},"children":[{"type":"text","value":"Disclosure"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"A last reminder: This library was not written by crypto- or security-experts. Please proceed at your own risk, inspect the code if you want to and open issues / pull requests where you see room for improvement. If you want to file a security-concern privately, please send an email to "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"support@sidestream.tech"}]},{"type":"text","value":" with the subject saying \"SECURITY nuxt-auth\" and we'll look into your request ASAP."}]}]},"_type":"markdown","_id":"content:2.guide:1.welcome:4.Security.md","_source":"content","_file":"2.guide/1.welcome/4.Security.md","_extension":"md"},{"_path":"/guide/configuration/nuxt-config","_dir":"configuration","_draft":false,"_partial":false,"_locale":"en","_empty":false,"title":"Nuxt Config","description":"Learn how to configure nuxt-auth inside of the nuxt-config.ts","excerpt":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"nuxtconfigts"},"children":[{"type":"text","value":"nuxt.config.ts"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Use the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"auth"}]},{"type":"text","value":"-key inside your "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"nuxt.config.ts"}]},{"type":"text","value":" to configure the module itself. Right now this is limited to the following options:"}]},{"type":"element","tag":"code","props":{"code":"export default defineNuxtConfig({\n  modules: ['@sidebase/nuxt-auth'],\n  auth: {\n    // The module is enabled. Change this to disable the module\n    isEnabled: true,\n\n    // The origin is set to the development origin. Change this when deploying to production\n    origin: 'http://localhost:300',\n\n    // The base path to the authentication endpoints. Change this if you want to add your auth-endpoints at a non-default location\n    basePath: '/api/auth'\n  }\n})\n","language":"ts"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"export default defineNuxtConfig({\n  modules: ['@sidebase/nuxt-auth'],\n  auth: {\n    // The module is enabled. Change this to disable the module\n    isEnabled: true,\n\n    // The origin is set to the development origin. Change this when deploying to production\n    origin: 'http://localhost:300',\n\n    // The base path to the authentication endpoints. Change this if you want to add your auth-endpoints at a non-default location\n    basePath: '/api/auth'\n  }\n})\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"origin"}]},{"type":"text","value":" and the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"basePath"}]},{"type":"text","value":" together are equivalent to the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"NEXTAUTH_URL"}]},{"type":"text","value":" environment variable of NextAuth.js"}]},{"type":"element","tag":"h2","props":{"id":"origin"},"children":[{"type":"text","value":"origin"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"You must set the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"origin"}]},{"type":"text","value":" in production, this includes when you run "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"npm run build"}]},{"type":"text","value":"!"}]},{"type":"text","value":" This is so that "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"nuxt-auth"}]},{"type":"text","value":" can ensure that callbacks for authentication are correct. The "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"origin"}]},{"type":"text","value":" consists out of (up to) 3 parts:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"scheme: "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"http"}]},{"type":"text","value":" or "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"https"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"host: e.g., "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"localhost"}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"example.org"}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"www.sidebase.io"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"port: e.g., "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":":3000"}]},{"type":"text","value":", "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":":4444"}]},{"type":"text","value":"; leave empty to implicitly set "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":":80"}]},{"type":"text","value":" (this is an internet convention, don't ask)"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"For "},{"type":"element","tag":"a","props":{"href":"https://nuxt-auth-example.sidebase.io","rel":["nofollow"]},"children":[{"type":"text","value":"the demo-app"}]},{"type":"text","value":" we set the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"origin"}]},{"type":"text","value":" to "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"https://nuxt-auth-example.sidebase.io"}]},{"type":"text","value":". If for some reason required, you can explicitly set the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"origin"}]},{"type":"text","value":" to "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"http://localhost:3000"}]},{"type":"text","value":" to stop "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"nuxt-auth"}]},{"type":"text","value":" from aborting "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"npm run build"}]},{"type":"text","value":" when the origin is unset."}]},{"type":"element","tag":"h2","props":{"id":"basepath"},"children":[{"type":"text","value":"basePath"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This is what tells the module where you added the authentication endpoints. Per default the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"basePath"}]},{"type":"text","value":" is set to "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/api/auth"}]},{"type":"text","value":", so that means that the module expects that all requests to "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"/api/auth/*"}]},{"type":"text","value":" will be handled by the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"NuxtAuthHandler"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"To statify this, you need to create a "},{"type":"element","tag":"a","props":{"href":"https://v3.nuxtjs.org/guide/directory-structure/server#catch-all-route","rel":["nofollow"]},"children":[{"type":"text","value":"catch-all server-route"}]},{"type":"text","value":" at that location by creating a file "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"~/server/api/auth/[...].ts"}]},{"type":"text","value":" that exports the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"NuxtAuthHandler"}]},{"type":"text","value":", see more on this in the "},{"type":"element","tag":"a","props":{"href":"#quick-start"},"children":[{"type":"text","value":"Quick Start"}]},{"type":"text","value":" or in the "},{"type":"element","tag":"a","props":{"href":"#serverapiauthts"},"children":[{"type":"text","value":"configuration section below"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If you want to have the authentication at another location, you can overwrite the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"basePath"}]},{"type":"text","value":", e.g., when setting:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"basePath: \"/api/_auth\""}]},{"type":"text","value":" -> add the authentication catch-all endpoints into "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"~/server/api/_auth/[...].ts"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"basePath: \"/_auth\""}]},{"type":"text","value":" -> add the authentication catch-all endpoints into "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"~/server/routes/_auth/[...].ts"}]},{"type":"text","value":" (see "},{"type":"element","tag":"a","props":{"href":"https://v3.nuxtjs.org/guide/directory-structure/server/#server-routes","rel":["nofollow"]},"children":[{"type":"text","value":"Nuxt server-routes docs on this"}]},{"type":"text","value":")"}]}]},{"type":"element","tag":"h2","props":{"id":"nuxtauthhandler"},"children":[{"type":"text","value":"NuxtAuthHandler"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Use the "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"NuxtAuthHandler({ ... })"}]},{"type":"text","value":" to configure how the authentication itself behaves:"}]},{"type":"element","tag":"code","props":{"code":"// file: ~/server/api/auth/[...].ts\nimport { NuxtAuthHandler } from '#auth'\n\nexport default NuxtAuthHandler({\n  // your authentication configuration here!\n})\n","language":"ts"},"children":[{"type":"element","tag":"pre","props":{},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"// file: ~/server/api/auth/[...].ts\nimport { NuxtAuthHandler } from '#auth'\n\nexport default NuxtAuthHandler({\n  // your authentication configuration here!\n})\n"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"NuxtAuthHandler"}]},{"type":"text","value":" accepts "},{"type":"element","tag":"a","props":{"href":"https://next-auth.js.org/configuration/options#options","rel":["nofollow"]},"children":[{"type":"text","value":"all options that NextAuth.js accepts for its API initialization"}]},{"type":"text","value":". Use this place to configure authentication providers (oauth-google, credential flow, ...), your "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"secret"}]},{"type":"text","value":" (equivalent to "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"NEXTAUTH_SECRET"}]},{"type":"text","value":" in NextAuth.js), add callbacks for authentication events, configure a custom logger and more. Read the linked "},{"type":"element","tag":"code-inline","props":{},"children":[{"type":"text","value":"NextAuth.js"}]},{"type":"text","value":" configuration to figure out how this works and what you can do."}]}]},"toc":true,"_type":"markdown","_id":"content:2.guide:2.configuration:1.nuxt-config.md","_source":"content","_file":"2.guide/2.configuration/1.nuxt-config.md","_extension":"md"}]